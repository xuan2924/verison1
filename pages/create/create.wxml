<!--pages/create/create.wxml-->
<view class="container">
  <!-- 顶部标题 -->
  <view class="header">
    <text class="title">创建新故事</text>
    <text class="subtitle">设置故事规则，邀请好友一起创作</text>
  </view>

  <!-- 表单区域 -->
  <view class="form-section">
    <!-- 故事标题 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">故事标题</text>
        <text class="label-required">*</text>
      </view>
      <input 
        class="form-input" 
        placeholder="给你的故事起个吸引人的名字" 
        placeholder-class="placeholder"
        bindinput="onTitleInput"
        value="{{title}}"
        maxlength="20"
      />
      <text class="word-count">{{title.length}}/20</text>
    </view>

    <!-- 故事主题 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">故事主题</text>
      </view>
      <view class="theme-grid">
        <view 
          class="theme-item {{selectedTheme === item ? 'active' : ''}}" 
          wx:for="{{themes}}" 
          wx:key="*this"
          bindtap="selectTheme"
          data-theme="{{item}}"
        >
          <text class="theme-icon">{{themeIcons[item]}}</text>
          <text class="theme-name">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- 参与人数 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">参与人数</text>
        <text class="label-desc">(包括自己)</text>
      </view>
      <view class="slider-container">
        <slider 
          min="2" 
          max="6" 
          step="1" 
          show-value 
          bindchange="onParticipantsChange"
          value="{{participants}}"
          activeColor="#FF6B95"
        />
        <view class="slider-labels">
          <text class="slider-label">2人</text>
          <text class="slider-label">6人</text>
        </view>
      </view>
      <text class="slider-value">当前：{{participants}}人</text>
    </view>

    <!-- 每轮时间 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">每轮写作时间</text>
      </view>
      <picker 
        range="{{timeLimits}}" 
        value="{{timeLimitIndex}}"
        bindchange="onTimeLimitChange"
      >
        <view class="picker">
          <text class="picker-value">{{timeLimits[timeLimitIndex]}}</text>
          <text class="picker-arrow">▼</text>
        </view>
      </picker>
    </view>

    <!-- 故事开头 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">故事开头</text>
        <text class="label-optional">(可选)</text>
      </view>
      <textarea 
        class="form-textarea" 
        placeholder="写一个精彩的开头，或者留空让AI生成..."
        placeholder-class="placeholder"
        bindinput="onOpeningInput"
        value="{{opening}}"
        maxlength="200"
        show-confirm-bar="{{false}}"
      />
      <view class="textarea-footer">
        <text class="word-count">{{opening.length}}/200</text>
        <text class="ai-tip" bindtap="generateOpening">✨ AI生成开头</text>
      </view>
    </view>

    <!-- 快速开头模板 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-text">快速开头模板</text>
      </view>
      <scroll-view scroll-x class="template-list">
        <view 
          class="template-item" 
          wx:for="{{openingTemplates}}" 
          wx:key="*this"
          bindtap="useTemplate"
          data-template="{{item}}"
        >
          <text class="template-text">{{item}}</text>
        </view>
      </scroll-view>
    </view>
  </view>

  <!-- 创建按钮 -->
  <view class="action-section">
    <button 
      class="create-button {{canCreate ? 'active' : ''}}" 
      bindtap="createStory"
      disabled="{{!canCreate || creating}}"
    >
      {{creating ? '创建中...' : '创建故事房间'}}
    </button>
    <text class="action-tip">创建后可以邀请好友加入</text>
  </view>
</view>